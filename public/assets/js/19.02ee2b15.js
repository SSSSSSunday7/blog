(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{445:function(e,v,_){"use strict";_.r(v);var a=_(2),s=Object(a.a)({},(function(){var e=this,v=e._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h1",{attrs:{id:"redis持久化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#redis持久化"}},[e._v("#")]),e._v(" Redis持久化")]),e._v(" "),v("h2",{attrs:{id:"_1、rdb-redis-database"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1、rdb-redis-database"}},[e._v("#")]),e._v(" 1、RDB（Redis database）")]),e._v(" "),v("blockquote",[v("p",[e._v("指定时间间隔内将内存中的数据快照写入磁盘，是某个时间点上数据的完整副本，可以通过配置文件的save参数来配置")])]),e._v(" "),v("p",[e._v("在配置文件中 写一行")]),e._v(" "),v("p",[v("code",[e._v("save 秒数 次数")])]),e._v(" "),v("p",[e._v("例如：")]),e._v(" "),v("p",[v("code",[e._v("save 3600 1")]),e._v("表示一个小时内只要进行了一次数据库操作,就进行保存")]),e._v(" "),v("p",[v("code",[e._v("save 600 100")]),e._v("表示在十分钟内进行100次操作才保存一次")]),e._v(" "),v("p",[e._v("或者直接在命令行执行"),v("code",[e._v("save")]),e._v("命令就可以保存一次快照")]),e._v(" "),v("p",[e._v("会保存为一个"),v("code",[e._v("dump.rdb")]),e._v("文件")]),e._v(" "),v("h3",{attrs:{id:"_1-1-防止阻塞"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-防止阻塞"}},[e._v("#")]),e._v(" 1.1 防止阻塞")]),e._v(" "),v("p",[e._v("当内存中的数据较大，同步到硬盘这个过程会导致redis阻塞，不能接受任何请求")]),e._v(" "),v("p",[e._v("于是redis提供了"),v("code",[e._v("bgsave")]),e._v("命令")]),e._v(" "),v("p",[e._v("该命令会单独创建一个子进程来负责将内存中的数据写入到硬盘中，这样主进程就可以继续处理请求，但是这个过程中"),v("strong",[e._v("仍然有性能损耗")]),e._v("。大部分时候还是无法继续处理请求。")]),e._v(" "),v("h2",{attrs:{id:"_2、aof-append-only-file"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2、aof-append-only-file"}},[e._v("#")]),e._v(" 2、AOF（Append Only File）")]),e._v(" "),v("blockquote",[v("p",[e._v("在执行命令的时候，不仅会写入到内存中，还会同时写入到硬盘，以日志形式记录每一个写操作，当redis重启的时候就会重新执行AOF文件中的命令")])]),e._v(" "),v("p",[e._v("开启方式，将配置文件中的"),v("code",[e._v("appendonly")]),e._v("参数改为"),v("code",[e._v("yes")])])])}),[],!1,null,null,null);v.default=s.exports}}]);