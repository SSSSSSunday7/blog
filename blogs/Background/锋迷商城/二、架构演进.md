# 二、架构演进

## 1.单体架构

 

### 单体项目

就是指前后端不分离项目，使用同一个服务器，不好做负载均衡，静态资源和动态资源无法分开，tomcat对静态资源的访问效率不高。

**例如** 

一个网页有50张图片，那么就要向tomcat发50次请求，效率低

## 2.前后端分离

+ 指前端和后端分开开发和部署（前端和后端项目在不同服务器上）
+ 优点：对静态资源访问和接口访问分离，tomcat只负责数据服务的访问

## 3.集群搭建（分布式）

通过负载均衡和增加服务器来解决高并发问题

有

+ 应用服务器集群
+ Redis集群
+ 分布式数据库

等集群，还涉及到mycat(分布式数据库)，ElasticSearch(数据库检索中间件)，rabbitMQ(消息中间件)

## 4.分布式

单纯的集群是增加tomcat服务器和物理硬件性能之类的来解决问题，但是容易出现其他问题。

数据库也有负载均衡服务器：mycat，和nginx的思路差不多

比如数据库的单机锁不生效，当多个线程或者说多个服务器同时访问一个资源，容易出现错误。

**例如：**

A、B、C都要购买*同一种商品*，但是商品只有*两件*

如果他们*同时下单*，因为他们被负载均衡到了多个服务器（线程）三个服务器*同时访问*，则会导致每个人*都能成功*，因为返回的结果都是还剩*两件*

这时就需要分布式锁了

## 4.1基于redis的分布式锁

购买商品之前先在redis中设置一个id，虽说是同时操作，但是一定有时间差，redis的响应是毫秒级的，所以后面的服务器在操作之前发现如果redis中有id存在了，故触发分布式锁。（看视频写的自己的理解，可能有误）



## 5.微服务

功能的增加，必然会导致系统整体出现故障的可能性提高，如果所有的功能都捆绑在一起，那么一个小模块出现故障，会导致整个系统无法正常运行*（就像你写的 java代码但凡一处有错误，整个项目都不能运行）*，所以就出现了微服务，将每个功能都分开部署，进一步解耦合。

**更多是解决可用性问题而不是并发问题。**

并且进一步优化了集群，如果你只有一个模块有高并发需求，那么只需要给那一个模块单独做集群就行了。

不过这样会出现一个模块间通信问题，这样的系统设计的更加复杂，对水平要求更高